# cbindgen configuration for zenoh-pico-shim-sys
# Generates c/include/zenoh_shim.h from src/ffi.rs

language = "C"
header = """/**
 * zenoh-pico-shim Public C API
 *
 * AUTO-GENERATED by cbindgen - DO NOT EDIT MANUALLY
 *
 * This header defines the high-level C API for zenoh-pico that can be
 * called from Rust FFI. It provides session management, publishers, and
 * subscribers with static storage.
 *
 * Platform-specific behavior (threading vs polling) is handled by the
 * backend interface in zenoh_smoltcp_platform.h
 */
"""
include_guard = "ZENOH_SHIM_H"
autogen_warning = "/* Warning: this file is autogenerated by cbindgen. Don't modify this manually. */"
include_version = false
no_includes = false

[defines]
# Note: We intentionally do NOT define "cbindgen" here.
# cbindgen automatically sets cfg(cbindgen)=true when parsing.
# By not mapping it to a C define, cbindgen filters items based on cfg
# rather than emitting C preprocessor guards.

[export.rename]
# Rename types if needed

[fn]
# Function configuration
rename_args = "None"

[struct]
rename_fields = "None"

[enum]
rename_variants = "None"

[parse]
parse_deps = false
# Don't emit extern "C" block declarations - we only want the stub functions
clean = true
# Only parse ffi.rs (not lib.rs which has the extern block imports)
include = ["ffi"]
# Exclude platform implementation modules
exclude = ["platform_smoltcp"]

[export]
# Include all exported items
exclude = []
include = [
    # Shim API - Session lifecycle
    "zenoh_shim_init",
    "zenoh_shim_open",
    "zenoh_shim_is_open",
    "zenoh_shim_close",
    # Shim API - Publishers
    "zenoh_shim_declare_publisher",
    "zenoh_shim_publish",
    "zenoh_shim_publish_with_attachment",
    "zenoh_shim_undeclare_publisher",
    # Shim API - Subscribers
    "zenoh_shim_declare_subscriber",
    "zenoh_shim_undeclare_subscriber",
    # Shim API - Polling
    "zenoh_shim_poll",
    "zenoh_shim_spin_once",
    "zenoh_shim_uses_polling",
    # Shim API - ZenohId
    "zenoh_shim_get_zid",
    # Shim API - Liveliness
    "zenoh_shim_declare_liveliness",
    "zenoh_shim_undeclare_liveliness",
    # Shim API - Queryables (Services)
    "zenoh_shim_declare_queryable",
    "zenoh_shim_undeclare_queryable",
    "zenoh_shim_query_reply",
    # Types
    "ShimCallback",
    "ShimQueryCallback",
    "PollCallback",
    # Constants
    "ZENOH_SHIM_MAX_PUBLISHERS",
    "ZENOH_SHIM_MAX_SUBSCRIBERS",
    "ZENOH_SHIM_MAX_LIVELINESS",
    "ZENOH_SHIM_MAX_QUERYABLES",
    "ZENOH_SHIM_ZID_SIZE",
    "ZENOH_SHIM_RMW_GID_SIZE",
    "ZENOH_SHIM_OK",
    "ZENOH_SHIM_ERR_GENERIC",
    "ZENOH_SHIM_ERR_CONFIG",
    "ZENOH_SHIM_ERR_SESSION",
    "ZENOH_SHIM_ERR_TASK",
    "ZENOH_SHIM_ERR_KEYEXPR",
    "ZENOH_SHIM_ERR_FULL",
    "ZENOH_SHIM_ERR_INVALID",
    "ZENOH_SHIM_ERR_PUBLISH",
    # smoltcp platform FFI
    "smoltcp_alloc",
    "smoltcp_realloc",
    "smoltcp_free",
    "smoltcp_random_u32",
    "smoltcp_set_clock_ms",
    "smoltcp_clock_now_ms",
    "smoltcp_set_poll_callback",
    "smoltcp_poll",
    "smoltcp_init",
    "smoltcp_cleanup",
    "smoltcp_socket_open",
    "smoltcp_socket_connect",
    "smoltcp_socket_is_connected",
    "smoltcp_socket_close",
    "smoltcp_socket_can_recv",
    "smoltcp_socket_can_send",
    "smoltcp_socket_recv",
    "smoltcp_socket_send",
    "smoltcp_socket_push_rx",
    "smoltcp_socket_pop_tx",
    "smoltcp_socket_get_remote",
    "smoltcp_socket_set_connected",
]
